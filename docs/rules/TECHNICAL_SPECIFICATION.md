# Техническое задание: Telegram Bot для мониторинга NFT подарков

## Описание проекта

**Цель:** Создать Telegram бота для мониторинга изменений в количестве NFT подарков на сайте https://peek.tg/search с целью отслеживания новых поступлений для последующей покупки.

## Функциональные требования

### 1. Основной функционал
- **Поиск подарков:** Возможность поиска NFT подарков по критериям:
  - Название подарка (обязательно)
  - Модель (опционально)
  - Фон (опционально) 
  - Узор (опционально)
- **Сохранение пресетов:** Сохранение поисковых запросов в базу данных
- **Мониторинг изменений:** Круглосуточная проверка изменений в количестве подарков
- **Уведомления:** Отправка уведомлений при изменении количества подарков

### 2. Интерфейс бота
- **Клавиатурный интерфейс:** Все взаимодействие через кнопки (не команды)
- **Красивый дизайн:** Современный и интуитивный интерфейс
- **Основные разделы:**
  - Добавить новый пресет для мониторинга
  - Просмотр сохраненных пресетов
  - Управление мониторингом (включить/выключить)
  - Настройки уведомлений

### 3. Технические требования
- **Парсинг данных:** Использование Playwright для извлечения данных с сайта
- **База данных:** SQLite для хранения пресетов и истории изменений
- **Мониторинг:** Фоновые задачи для проверки изменений
- **Логирование:** Подробное логирование всех операций

## Технический стек

- **Backend:** Node.js + TypeScript
- **База данных:** SQLite
- **Парсинг:** Playwright
- **Telegram API:** node-telegram-bot-api или grammy
- **Планировщик задач:** node-cron

## Структура базы данных

### Таблица `presets`
- `id` - уникальный идентификатор
- `user_id` - ID пользователя Telegram
- `gift_name` - название подарка
- `model` - модель (nullable)
- `background` - фон (nullable)
- `pattern` - узор (nullable)
- `is_active` - активен ли мониторинг
- `created_at` - дата создания
- `updated_at` - дата обновления

### Таблица `monitoring_history`
- `id` - уникальный идентификатор
- `preset_id` - ссылка на пресет
- `count` - количество найденных подарков
- `checked_at` - время проверки
- `has_changed` - изменилось ли количество

## Пользовательские сценарии

### 1. Добавление нового пресета
1. Пользователь нажимает "Добавить пресет"
2. Вводит название подарка (обязательно)
3. Опционально выбирает модель, фон, узор
4. Подтверждает создание пресета
5. Пресет сохраняется в БД

### 2. Мониторинг изменений
1. Система периодически проверяет все активные пресеты
2. Сравнивает текущее количество с предыдущим
3. При изменении отправляет уведомление пользователю
4. Обновляет историю в БД

### 3. Управление пресетами
1. Просмотр списка сохраненных пресетов
2. Включение/выключение мониторинга
3. Редактирование пресетов
4. Удаление пресетов

## Критерии приемки

- [ ] Бот успешно парсит данные с сайта peek.tg
- [ ] Пользователь может создавать пресеты через кнопки
- [ ] Система корректно сохраняет данные в SQLite
- [ ] Мониторинг работает в фоновом режиме
- [ ] Уведомления приходят при изменении количества
- [ ] Интерфейс интуитивно понятен и красив
- [ ] Система устойчива к ошибкам парсинга
- [ ] Логирование всех операций работает корректно
